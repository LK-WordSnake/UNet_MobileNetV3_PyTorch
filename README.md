    # Model
    check_suffix(weights, '.pt')  # check weights
    pretrained = weights.endswith('.pt')
    if pretrained:
        # with torch_distributed_zero_first(LOCAL_RANK):
        #     weights = attempt_download(weights)  # download if not found locally
        # ckpt = torch.load(weights, map_location=device)  # load checkpoint
        # model = Model(cfg or ckpt['model'].yaml, ch=3, nc=nc, anchors=hyp.get('anchors')).to(device)  # create
        # exclude = ['anchor'] if (cfg or hyp.get('anchors')) and not resume else []  # exclude keys
        # csd = ckpt['model'].float().state_dict()  # checkpoint state_dict as FP32
        # csd = intersect_dicts(csd, model.state_dict(), exclude=exclude)  # intersect
        # model.load_state_dict(csd, strict=False)  # load
        # LOGGER.info(f'Transferred {len(csd)}/{len(model.state_dict())} items from {weights}')  # report
        weights_dict = torch.load(weights, map_location=device)
        model = Model(cfg, ch=3, nc=nc, anchors=hyp.get('anchors')).to(device)
        new_weights = OrderedDict()
        down_layers = OrderedDict()
        stage_layers = OrderedDict()
        for k, v in weights_dict['model'].items():
            names = k.split('.')
            if names[0] == 'downsample_layers':
                down_layers[k] = v
            elif names[0] == 'stages':
                stage_layers[k] = v

        new_weights['model.0.0.weight'] = down_layers['downsample_layers.0.0.weight']
        new_weights['model.0.0.bias'] = down_layers['downsample_layers.0.0.bias']
        new_weights['model.0.1.weight'] = down_layers['downsample_layers.0.1.weight']
        new_weights['model.0.1.bias'] = down_layers['downsample_layers.0.1.bias']

        new_weights['model.1.0.gamma'] = stage_layers['stages.0.0.gamma']
        new_weights['model.1.0.dwconv.weight'] = stage_layers['stages.0.0.dwconv.weight']
        new_weights['model.1.0.dwconv.bias'] = stage_layers['stages.0.0.dwconv.bias']
        new_weights['model.1.0.norm.weight'] = stage_layers['stages.0.0.norm.weight']
        new_weights['model.1.0.norm.bias'] = stage_layers['stages.0.0.norm.bias']
        new_weights['model.1.0.pwconv1.weight'] = stage_layers['stages.0.0.pwconv1.weight']
        new_weights['model.1.0.pwconv1.bias'] = stage_layers['stages.0.0.pwconv1.bias']
        new_weights['model.1.0.pwconv2.weight'] = stage_layers['stages.0.0.pwconv2.weight']
        new_weights['model.1.0.pwconv2.bias'] = stage_layers['stages.0.0.pwconv2.bias']
        new_weights['model.1.1.gamma'] = stage_layers['stages.0.1.gamma']
        new_weights['model.1.1.dwconv.weight'] = stage_layers['stages.0.1.dwconv.weight']
        new_weights['model.1.1.dwconv.bias'] = stage_layers['stages.0.1.dwconv.bias']
        new_weights['model.1.1.norm.weight'] = stage_layers['stages.0.1.norm.weight']
        new_weights['model.1.1.norm.bias'] = stage_layers['stages.0.1.norm.bias']
        new_weights['model.1.1.pwconv1.weight'] = stage_layers['stages.0.1.pwconv1.weight']
        new_weights['model.1.1.pwconv1.bias'] = stage_layers['stages.0.1.pwconv1.bias']
        new_weights['model.1.1.pwconv2.weight'] = stage_layers['stages.0.1.pwconv2.weight']
        new_weights['model.1.1.pwconv2.bias'] = stage_layers['stages.0.1.pwconv2.bias']
        new_weights['model.1.2.gamma'] = stage_layers['stages.0.2.gamma']
        new_weights['model.1.2.dwconv.weight'] = stage_layers['stages.0.2.dwconv.weight']
        new_weights['model.1.2.dwconv.bias'] = stage_layers['stages.0.2.dwconv.bias']
        new_weights['model.1.2.norm.weight'] = stage_layers['stages.0.2.norm.weight']
        new_weights['model.1.2.norm.bias'] = stage_layers['stages.0.2.norm.bias']
        new_weights['model.1.2.pwconv1.weight'] = stage_layers['stages.0.2.pwconv1.weight']
        new_weights['model.1.2.pwconv1.bias'] = stage_layers['stages.0.2.pwconv1.bias']
        new_weights['model.1.2.pwconv2.weight'] = stage_layers['stages.0.2.pwconv2.weight']
        new_weights['model.1.2.pwconv2.bias'] = stage_layers['stages.0.2.pwconv2.bias']

        new_weights['model.2.0.weight'] = down_layers['downsample_layers.1.0.weight']
        new_weights['model.2.0.bias'] = down_layers['downsample_layers.1.0.bias']
        new_weights['model.2.1.weight'] = down_layers['downsample_layers.1.1.weight']
        new_weights['model.2.1.bias'] = down_layers['downsample_layers.1.1.bias']

        new_weights['model.3.0.gamma'] = stage_layers['stages.1.0.gamma']
        new_weights['model.3.0.dwconv.weight'] = stage_layers['stages.1.0.dwconv.weight']
        new_weights['model.3.0.dwconv.bias'] = stage_layers['stages.1.0.dwconv.bias']
        new_weights['model.3.0.norm.weight'] = stage_layers['stages.1.0.norm.weight']
        new_weights['model.3.0.norm.bias'] = stage_layers['stages.1.0.norm.bias']
        new_weights['model.3.0.pwconv1.weight'] = stage_layers['stages.1.0.pwconv1.weight']
        new_weights['model.3.0.pwconv1.bias'] = stage_layers['stages.1.0.pwconv1.bias']
        new_weights['model.3.0.pwconv2.weight'] = stage_layers['stages.1.0.pwconv2.weight']
        new_weights['model.3.0.pwconv2.bias'] = stage_layers['stages.1.0.pwconv2.bias']
        new_weights['model.3.1.gamma'] = stage_layers['stages.1.1.gamma']
        new_weights['model.3.1.dwconv.weight'] = stage_layers['stages.1.1.dwconv.weight']
        new_weights['model.3.1.dwconv.bias'] = stage_layers['stages.1.1.dwconv.bias']
        new_weights['model.3.1.norm.weight'] = stage_layers['stages.1.1.norm.weight']
        new_weights['model.3.1.norm.bias'] = stage_layers['stages.1.1.norm.bias']
        new_weights['model.3.1.pwconv1.weight'] = stage_layers['stages.1.1.pwconv1.weight']
        new_weights['model.3.1.pwconv1.bias'] = stage_layers['stages.1.1.pwconv1.bias']
        new_weights['model.3.1.pwconv2.weight'] = stage_layers['stages.1.1.pwconv2.weight']
        new_weights['model.3.1.pwconv2.bias'] = stage_layers['stages.1.1.pwconv2.bias']
        new_weights['model.3.2.gamma'] = stage_layers['stages.1.2.gamma']
        new_weights['model.3.2.dwconv.weight'] = stage_layers['stages.1.2.dwconv.weight']
        new_weights['model.3.2.dwconv.bias'] = stage_layers['stages.1.2.dwconv.bias']
        new_weights['model.3.2.norm.weight'] = stage_layers['stages.1.2.norm.weight']
        new_weights['model.3.2.norm.bias'] = stage_layers['stages.1.2.norm.bias']
        new_weights['model.3.2.pwconv1.weight'] = stage_layers['stages.1.2.pwconv1.weight']
        new_weights['model.3.2.pwconv1.bias'] = stage_layers['stages.1.2.pwconv1.bias']
        new_weights['model.3.2.pwconv2.weight'] = stage_layers['stages.1.2.pwconv2.weight']
        new_weights['model.3.2.pwconv2.bias'] = stage_layers['stages.1.2.pwconv2.bias']

        new_weights['model.4.0.weight'] = down_layers['downsample_layers.2.0.weight']
        new_weights['model.4.0.bias'] = down_layers['downsample_layers.2.0.bias']
        new_weights['model.4.1.weight'] = down_layers['downsample_layers.2.1.weight']
        new_weights['model.4.1.bias'] = down_layers['downsample_layers.2.1.bias']

        new_weights['model.5.0.gamma'] = stage_layers['stages.2.0.gamma']
        new_weights['model.5.0.dwconv.weight'] = stage_layers['stages.2.0.dwconv.weight']
        new_weights['model.5.0.dwconv.bias'] = stage_layers['stages.2.0.dwconv.bias']
        new_weights['model.5.0.norm.weight'] = stage_layers['stages.2.0.norm.weight']
        new_weights['model.5.0.norm.bias'] = stage_layers['stages.2.0.norm.bias']
        new_weights['model.5.0.pwconv1.weight'] = stage_layers['stages.2.0.pwconv1.weight']
        new_weights['model.5.0.pwconv1.bias'] = stage_layers['stages.2.0.pwconv1.bias']
        new_weights['model.5.0.pwconv2.weight'] = stage_layers['stages.2.0.pwconv2.weight']
        new_weights['model.5.0.pwconv2.bias'] = stage_layers['stages.2.0.pwconv2.bias']
        new_weights['model.5.1.gamma'] = stage_layers['stages.2.1.gamma']
        new_weights['model.5.1.dwconv.weight'] = stage_layers['stages.2.1.dwconv.weight']
        new_weights['model.5.1.dwconv.bias'] = stage_layers['stages.2.1.dwconv.bias']
        new_weights['model.5.1.norm.weight'] = stage_layers['stages.2.1.norm.weight']
        new_weights['model.5.1.norm.bias'] = stage_layers['stages.2.1.norm.bias']
        new_weights['model.5.1.pwconv1.weight'] = stage_layers['stages.2.1.pwconv1.weight']
        new_weights['model.5.1.pwconv1.bias'] = stage_layers['stages.2.1.pwconv1.bias']
        new_weights['model.5.1.pwconv2.weight'] = stage_layers['stages.2.1.pwconv2.weight']
        new_weights['model.5.1.pwconv2.bias'] = stage_layers['stages.2.1.pwconv2.bias']
        new_weights['model.5.2.gamma'] = stage_layers['stages.2.2.gamma']
        new_weights['model.5.2.dwconv.weight'] = stage_layers['stages.2.2.dwconv.weight']
        new_weights['model.5.2.dwconv.bias'] = stage_layers['stages.2.2.dwconv.bias']
        new_weights['model.5.2.norm.weight'] = stage_layers['stages.2.2.norm.weight']
        new_weights['model.5.2.norm.bias'] = stage_layers['stages.2.2.norm.bias']
        new_weights['model.5.2.pwconv1.weight'] = stage_layers['stages.2.2.pwconv1.weight']
        new_weights['model.5.2.pwconv1.bias'] = stage_layers['stages.2.2.pwconv1.bias']
        new_weights['model.5.2.pwconv2.weight'] = stage_layers['stages.2.2.pwconv2.weight']
        new_weights['model.5.2.pwconv2.bias'] = stage_layers['stages.2.2.pwconv2.bias']
        new_weights['model.5.3.gamma'] = stage_layers['stages.2.3.gamma']
        new_weights['model.5.3.dwconv.weight'] = stage_layers['stages.2.3.dwconv.weight']
        new_weights['model.5.3.dwconv.bias'] = stage_layers['stages.2.3.dwconv.bias']
        new_weights['model.5.3.norm.weight'] = stage_layers['stages.2.3.norm.weight']
        new_weights['model.5.3.norm.bias'] = stage_layers['stages.2.3.norm.bias']
        new_weights['model.5.3.pwconv1.weight'] = stage_layers['stages.2.3.pwconv1.weight']
        new_weights['model.5.3.pwconv1.bias'] = stage_layers['stages.2.3.pwconv1.bias']
        new_weights['model.5.3.pwconv2.weight'] = stage_layers['stages.2.3.pwconv2.weight']
        new_weights['model.5.3.pwconv2.bias'] = stage_layers['stages.2.3.pwconv2.bias']
        new_weights['model.5.4.gamma'] = stage_layers['stages.2.4.gamma']
        new_weights['model.5.4.dwconv.weight'] = stage_layers['stages.2.4.dwconv.weight']
        new_weights['model.5.4.dwconv.bias'] = stage_layers['stages.2.4.dwconv.bias']
        new_weights['model.5.4.norm.weight'] = stage_layers['stages.2.4.norm.weight']
        new_weights['model.5.4.norm.bias'] = stage_layers['stages.2.4.norm.bias']
        new_weights['model.5.4.pwconv1.weight'] = stage_layers['stages.2.4.pwconv1.weight']
        new_weights['model.5.4.pwconv1.bias'] = stage_layers['stages.2.4.pwconv1.bias']
        new_weights['model.5.4.pwconv2.weight'] = stage_layers['stages.2.4.pwconv2.weight']
        new_weights['model.5.4.pwconv2.bias'] = stage_layers['stages.2.4.pwconv2.bias']
        new_weights['model.5.5.gamma'] = stage_layers['stages.2.5.gamma']
        new_weights['model.5.5.dwconv.weight'] = stage_layers['stages.2.5.dwconv.weight']
        new_weights['model.5.5.dwconv.bias'] = stage_layers['stages.2.5.dwconv.bias']
        new_weights['model.5.5.norm.weight'] = stage_layers['stages.2.5.norm.weight']
        new_weights['model.5.5.norm.bias'] = stage_layers['stages.2.5.norm.bias']
        new_weights['model.5.5.pwconv1.weight'] = stage_layers['stages.2.5.pwconv1.weight']
        new_weights['model.5.5.pwconv1.bias'] = stage_layers['stages.2.5.pwconv1.bias']
        new_weights['model.5.5.pwconv2.weight'] = stage_layers['stages.2.5.pwconv2.weight']
        new_weights['model.5.5.pwconv2.bias'] = stage_layers['stages.2.5.pwconv2.bias']
        new_weights['model.5.6.gamma'] = stage_layers['stages.2.6.gamma']
        new_weights['model.5.6.dwconv.weight'] = stage_layers['stages.2.6.dwconv.weight']
        new_weights['model.5.6.dwconv.bias'] = stage_layers['stages.2.6.dwconv.bias']
        new_weights['model.5.6.norm.weight'] = stage_layers['stages.2.6.norm.weight']
        new_weights['model.5.6.norm.bias'] = stage_layers['stages.2.6.norm.bias']
        new_weights['model.5.6.pwconv1.weight'] = stage_layers['stages.2.6.pwconv1.weight']
        new_weights['model.5.6.pwconv1.bias'] = stage_layers['stages.2.6.pwconv1.bias']
        new_weights['model.5.6.pwconv2.weight'] = stage_layers['stages.2.6.pwconv2.weight']
        new_weights['model.5.6.pwconv2.bias'] = stage_layers['stages.2.6.pwconv2.bias']
        new_weights['model.5.7.gamma'] = stage_layers['stages.2.7.gamma']
        new_weights['model.5.7.dwconv.weight'] = stage_layers['stages.2.7.dwconv.weight']
        new_weights['model.5.7.dwconv.bias'] = stage_layers['stages.2.7.dwconv.bias']
        new_weights['model.5.7.norm.weight'] = stage_layers['stages.2.7.norm.weight']
        new_weights['model.5.7.norm.bias'] = stage_layers['stages.2.7.norm.bias']
        new_weights['model.5.7.pwconv1.weight'] = stage_layers['stages.2.7.pwconv1.weight']
        new_weights['model.5.7.pwconv1.bias'] = stage_layers['stages.2.7.pwconv1.bias']
        new_weights['model.5.7.pwconv2.weight'] = stage_layers['stages.2.7.pwconv2.weight']
        new_weights['model.5.7.pwconv2.bias'] = stage_layers['stages.2.7.pwconv2.bias']
        new_weights['model.5.8.gamma'] = stage_layers['stages.2.8.gamma']
        new_weights['model.5.8.dwconv.weight'] = stage_layers['stages.2.8.dwconv.weight']
        new_weights['model.5.8.dwconv.bias'] = stage_layers['stages.2.8.dwconv.bias']
        new_weights['model.5.8.norm.weight'] = stage_layers['stages.2.8.norm.weight']
        new_weights['model.5.8.norm.bias'] = stage_layers['stages.2.8.norm.bias']
        new_weights['model.5.8.pwconv1.weight'] = stage_layers['stages.2.8.pwconv1.weight']
        new_weights['model.5.8.pwconv1.bias'] = stage_layers['stages.2.8.pwconv1.bias']
        new_weights['model.5.8.pwconv2.weight'] = stage_layers['stages.2.8.pwconv2.weight']
        new_weights['model.5.8.pwconv2.bias'] = stage_layers['stages.2.8.pwconv2.bias']

        new_weights['model.6.0.weight'] = down_layers['downsample_layers.3.0.weight']
        new_weights['model.6.0.bias'] = down_layers['downsample_layers.3.0.bias']
        new_weights['model.6.1.weight'] = down_layers['downsample_layers.3.1.weight']
        new_weights['model.6.1.bias'] = down_layers['downsample_layers.3.1.bias']

        new_weights['model.7.0.gamma'] = stage_layers['stages.3.0.gamma']
        new_weights['model.7.0.dwconv.weight'] = stage_layers['stages.3.0.dwconv.weight']
        new_weights['model.7.0.dwconv.bias'] = stage_layers['stages.3.0.dwconv.bias']
        new_weights['model.7.0.norm.weight'] = stage_layers['stages.3.0.norm.weight']
        new_weights['model.7.0.norm.bias'] = stage_layers['stages.3.0.norm.bias']
        new_weights['model.7.0.pwconv1.weight'] = stage_layers['stages.3.0.pwconv1.weight']
        new_weights['model.7.0.pwconv1.bias'] = stage_layers['stages.3.0.pwconv1.bias']
        new_weights['model.7.0.pwconv2.weight'] = stage_layers['stages.3.0.pwconv2.weight']
        new_weights['model.7.0.pwconv2.bias'] = stage_layers['stages.3.0.pwconv2.bias']
        new_weights['model.7.1.gamma'] = stage_layers['stages.3.1.gamma']
        new_weights['model.7.1.dwconv.weight'] = stage_layers['stages.3.1.dwconv.weight']
        new_weights['model.7.1.dwconv.bias'] = stage_layers['stages.3.1.dwconv.bias']
        new_weights['model.7.1.norm.weight'] = stage_layers['stages.3.1.norm.weight']
        new_weights['model.7.1.norm.bias'] = stage_layers['stages.3.1.norm.bias']
        new_weights['model.7.1.pwconv1.weight'] = stage_layers['stages.3.1.pwconv1.weight']
        new_weights['model.7.1.pwconv1.bias'] = stage_layers['stages.3.1.pwconv1.bias']
        new_weights['model.7.1.pwconv2.weight'] = stage_layers['stages.3.1.pwconv2.weight']
        new_weights['model.7.1.pwconv2.bias'] = stage_layers['stages.3.1.pwconv2.bias']
        new_weights['model.7.2.gamma'] = stage_layers['stages.3.2.gamma']
        new_weights['model.7.2.dwconv.weight'] = stage_layers['stages.3.2.dwconv.weight']
        new_weights['model.7.2.dwconv.bias'] = stage_layers['stages.3.2.dwconv.bias']
        new_weights['model.7.2.norm.weight'] = stage_layers['stages.3.2.norm.weight']
        new_weights['model.7.2.norm.bias'] = stage_layers['stages.3.2.norm.bias']
        new_weights['model.7.2.pwconv1.weight'] = stage_layers['stages.3.2.pwconv1.weight']
        new_weights['model.7.2.pwconv1.bias'] = stage_layers['stages.3.2.pwconv1.bias']
        new_weights['model.7.2.pwconv2.weight'] = stage_layers['stages.3.2.pwconv2.weight']
        new_weights['model.7.2.pwconv2.bias'] = stage_layers['stages.3.2.pwconv2.bias']


        load_weights_dict = {k: v for k, v in new_weights.items()
                             if model.state_dict()[k].numel() == v.numel()}
        model.load_state_dict(load_weights_dict, strict=False)
    else:
        model = Model(cfg, ch=3, nc=nc, anchors=hyp.get('anchors')).to(device)  # create
